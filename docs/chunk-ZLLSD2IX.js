import{a as h}from"./chunk-CGH4GANM.js";import"./chunk-NCOWMHCX.js";import{a as g}from"./chunk-K5QFLXY4.js";import"./chunk-4WCN3XK4.js";import{a}from"./chunk-Z7774WOE.js";import{M as r,Sa as l,Ta as p,Tb as w,ja as d,xa as c}from"./chunk-2UQX2IQT.js";import{a as i,b as o,g as v}from"./chunk-P2VZOJAX.js";var f=v(w());var k={title:"Retrieving Rows",mdFile:"./index.md",order:1,category:h},s=k;var m=[];var j={},u=j;var x=`<h1 id="retrieving-rows" class="ngde">Retrieving Rows<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#retrieving-rows"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h1><h2 id="introduction" class="ngde">Introduction<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#introduction"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">SmartNgRX expects every row within an entity that has children to have an array of IDs that point to the children. By using the <code class="ngde ng-doc-code-with-link" class="ngde"><a href="/api/smart-ngrx/functions/createSmartSelector" class="ng-doc-code-anchor ngde" data-link-type="Function" class="ngde">createSmartSelector</a></code> function, you will automatically get the children of the row you are retrieving when you access the array element. You will not need to dispatch any actions for this to happen. It will just work.</p><p class="ngde">See the <a href="/using-smart-ng-rx/smart-selectors" class="ngde">Smart Selectors</a> section for more information.</p><h2 id="effects-service" class="ngde">Effects Service<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#effects-service"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">What you will need to provide is the effects service that will retrieve the rows from the server. You will need to implement the <code class="ngde">loadByIds</code> method. This method will be called with the list of IDs the code has determined it does not yet have or have been marked as dirty and it needs to render on the screen some place.</p><p class="ngde">Keep in mind that any time you access an array element directly, you will trigger the retrieval process for that row. This is by design. If you want to retrieve the ID and not the row, you can use the array's <code class="ngde">rawArray</code> property. You might use this if you are iterating through the array for the purposes of virtual scrolling as we've done in the example code.</p><h2 id="sample-code" class="ngde">Sample Code<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#sample-code"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">Here is a sample implementation of a <code class="ngde">loadByIds</code> method from the SmartNgRX Demo application:</p><pre class="ngde hljs"><code class="hljs language-typescript code-lines ngde" lang="typescript" name="" icon="" highlightedlines="[]"><span class="line ngde">  <span class="hljs-keyword ngde">override</span> <span class="hljs-attr ngde">loadByIds</span>: <span class="hljs-function ngde">(<span class="hljs-params ngde">ids: <span class="hljs-built_in ngde">string</span>[]</span>) =></span> <span class="hljs-title class_ ngde">Observable</span>&#x3C;<span class="hljs-title class_ ngde">Department</span>[]> = (<span class="hljs-params ngde"></span>
</span><span class="line ngde"><span class="hljs-params ngde">    ids: </span><span class="hljs-built_in ngde">string</span><span class="hljs-params ngde">[],</span>
</span><span class="line ngde"><span class="hljs-params ngde">  </span>) => {
</span><span class="line ngde">    <span class="hljs-keyword ngde">return</span> <span class="hljs-variable language_ ngde">this</span>.<span class="hljs-property ngde">http</span>.<span class="hljs-property ngde">post</span>&#x3C;<span class="hljs-title class_ ngde">Department</span>[]>(<span class="hljs-string ngde">'./api/departments'</span>, ids).<span class="hljs-title function_ ngde">pipe</span>(
</span><span class="line ngde">      <span class="hljs-title function_ ngde">map</span>(<span class="hljs-function ngde">(<span class="hljs-params ngde">departments</span>) =></span> <span class="hljs-title function_ ngde">addIsDirty</span>(departments) <span class="hljs-keyword ngde">as</span> <span class="hljs-title class_ ngde">Department</span>[]),
</span><span class="line ngde">      <span class="hljs-title function_ ngde">map</span>(childrenTransform),
</span><span class="line ngde">    );
</span><span class="line ngde">  };
</span></code></pre><p class="ngde">You might notice that we are using a POST instead of a GET to retrieve the data. If you prefer, you can use a GET. We've chosen to use a POST because we can send a list of IDs to the server and we want that list of IDs to be as large as needed and not limited by the URL size restrictions inherent in using GET.</p><h2 id="addisdirty" class="ngde">addIsDirty<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#addisdirty"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">You'll also notice the call to <code class="ngde">addIsDirty</code>. This is a function we use to add in the <code class="ngde">isDirty</code> property to each row. This is a property that is used by SmartNgRX to determine if the row needs to be retrieved from the server.</p><h2 id="dealing-with-children-that-are-from-multiple-entities" class="ngde">Dealing with children that are from multiple entities<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#dealing-with-children-that-are-from-multiple-entities"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">One interesting problem you might run into is that you might need to retrieve children from multiple entities (that then retrieve from the server if they don't exist). This is, in part what the <code class="ngde">childrenTransform</code> function is for. It will take the children from the server and transform them into the correct entity type so we can redirect to the right end point when we retrieve the data.</p><p class="ngde">If you have a use case like this, we invite you to examine the Demo application to see how we've handled this issue. This is one of several ways you might handle the problem. You might also consider handling this on the server.</p><h2 id="retrieving-the-top-level-store" class="ngde">Retrieving the top level store<a title="Link to heading" class="ng-doc-header-link ngde" href="/using-smart-ng-rx/crud-support/retrieving#retrieving-the-top-level-store"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">At this time, we've not implemented a cleaver way to retrieve the top level store in your application, so you'll need to retrieve that yourself. We are working on a way to do that aligns with how the rest of SmartNgRX works.</p><p class="ngde">You can, however, use the actions and reducers we create by calling <code class="ngde">createAction</code> to create the actions and registering the entity using <code class="ngde ng-doc-code-with-link" class="ngde"><a href="/api/smart-ngrx/functions/provideSmartFeatureEntities" class="ng-doc-code-anchor ngde" data-link-type="Function" class="ngde">provideSmartFeatureEntities</a></code>.</p><p class="ngde">You can see how we've implemented this by looking at the Location code in the Demo application.</p>`,D=(()=>{let e=class e extends a{constructor(){super(),this.routePrefix="",this.pageType="guide",this.pageContent=x,this.page=s,this.demoAssets=u}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r({type:e,selectors:[["ng-doc-page-using-smart-ng-rx-crud-support-retrieving"]],standalone:!0,features:[l([{provide:a,useExisting:e},m,s.providers??[]]),d,p],decls:1,vars:0,template:function(t,R){t&1&&c(0,"ng-doc-page")},dependencies:[g],encapsulation:2,changeDetection:0});let n=e;return n})(),S=[o(i({},(0,f.isRoute)(s.route)?s.route:{}),{path:"",component:D,title:"Retrieving Rows"})],_=S;export{D as DynamicComponent,_ as default};
